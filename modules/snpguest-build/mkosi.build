#!/bin/bash
set -euo pipefail
set -x

# Use SNPGUEST_TAG if set, otherwise fetch from GitHub API
LATEST_TAG="${SNPGUEST_TAG:-$(curl -s https://api.github.com/repos/virtee/snpguest/releases/latest | jq -r '.tag_name')}"

# Download and install into DESTDIR with correct permissions
curl -fsSL "https://github.com/virtee/snpguest/releases/download/${LATEST_TAG}/snpguest" \
  | install -D -m 0755 /dev/stdin "${DESTDIR}/usr/local/bin/snpguest"
